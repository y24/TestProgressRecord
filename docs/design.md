# テスト進捗管理システム 詳細設計書

## 1. システム概要

### 1.1 目的
テスト進捗管理システムは、テスト実行の進捗状況を効率的に管理・可視化するためのツールです。日々のテスト結果を記録し、進捗状況をグラフやテーブルで表示することで、プロジェクトの状況を把握しやすくします。

### 1.2 主要機能
- テスト結果データの入力と管理
- 進捗状況の可視化（グラフ表示）
- 環境別・日付別・担当者別の集計表示
- プロジェクト設定の管理
- データのエクスポート機能

## 2. システム構成

### 2.1 アプリケーション構成
```
TestProgressTracker/
├── MainApp.py          # メインアプリケーション
├── LauncherApp.py      # ランチャーアプリケーション
├── ProjectEditorApp.py # プロジェクト設定エディタ
├── ApiConfigApp.py     # API設定エディタ
├── ReadData.py         # データ読み込みモジュール
├── WriteData.py        # データ書き込みモジュール
├── StartProcess.py     # プロセス起動管理
├── libs/               # 共通ライブラリ
├── projects/          # プロジェクト設定ファイル
└── input_sample/      # 入力サンプルデータ
```

### 2.2 主要モジュール説明

#### MainApp.py
- メインウィンドウの管理
- データ表示（グラフ・テーブル）
- メニュー操作
- ファイル操作

#### ReadData.py
- Excelファイルの読み込み
- データの解析と整形
- 進捗状況の計算

#### WriteData.py
- データの保存
- CSVファイルの出力
- 設定ファイルの管理

## 3. データ構造

### 3.1 プロジェクト設定
```json
{
    "test_status": {
        "results": ["成功", "失敗", "保留"],
        "labels": {
            "completed": "完了",
            "executed": "実行済"
        }
    }
}
```

### 3.2 テスト結果データ
- 日付別データ構造
- 環境別データ構造
- 担当者別データ構造

## 4. 画面設計

### 4.1 メイン画面
- メニューバー
- タブ表示（全体集計、ファイル別、グローバル）
- グラフ表示エリア
- テーブル表示エリア

### 4.2 プロジェクト設定画面
- プロジェクト情報入力
- テストステータス設定
- 環境設定

## 5. 機能詳細

### 5.1 データ表示機能
- 日付別集計
- 環境別集計
- 担当者別集計
- グラフ表示（棒グラフ）
- テーブル表示（Treeview）

### 5.2 データ管理機能
- CSVファイルの読み込み
- データの保存
- プロジェクト設定の保存
- データのエクスポート

### 5.3 ユーティリティ機能
- クリップボードへのコピー
- ファイル実行
- 設定の編集
- プロジェクトの編集

## 6. 技術仕様

### 6.1 使用技術
- Python 3.x
- tkinter (GUI)
- matplotlib (グラフ表示)
- pandas (データ処理)
- numpy (数値計算)

### 6.2 外部依存
- japanize_matplotlib
- tktooltip

## 7. エラー処理

### 7.1 想定されるエラー
- ファイル読み込みエラー
- データ形式エラー
- 設定ファイルエラー
- プロジェクト設定エラー

### 7.2 エラー処理方針
- ユーザーフレンドリーなエラーメッセージ
- エラー発生時のログ記録
- リカバリー処理の実装

## 8. セキュリティ

### 8.1 データ保護
- 設定ファイルのバックアップ
- プロジェクトデータのバックアップ
- ファイル操作の権限管理

### 8.2 入力値検証
- ファイルパスの検証
- 設定値の検証
- データ形式の検証 